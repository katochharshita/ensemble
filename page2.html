<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Santa's Gift Tree - Page 2: Bagging & Majority Voting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .language-selector {
            text-align: right;
            margin-bottom: 20px;
            padding: 10px 0;
        }

        .language-selector select {
            padding: 8px 12px;
            font-size: 1em;
            border: 2px solid #667eea;
            border-radius: 5px;
            background: white;
            color: #333;
            cursor: pointer;
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
        }

        .language-selector select:hover {
            border-color: #5568d3;
        }

        h1 {
            text-align: center;
            color: #764ba2;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .intro {
            text-align: center;
            font-size: 1.2em;
            color: #555;
            margin-bottom: 40px;
            line-height: 1.6;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .student-section {
            margin-bottom: 50px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 3px solid #667eea;
        }

        .student-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .student-header h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .student-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.3em;
            margin-bottom: 30px;
        }

        .predictions-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .prediction-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .prediction-panel.main-elf {
            border-top: 5px solid #2196F3;
        }

        .prediction-panel.all-elves {
            border-top: 5px solid #4CAF50;
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
        }

        .panel-header.main-elf {
            color: #2196F3;
        }

        .panel-header.all-elves {
            color: #4CAF50;
        }

        .main-elf-prediction {
            text-align: center;
            padding: 30px;
            background: #e3f2fd;
            border-radius: 10px;
            font-size: 2em;
            font-weight: bold;
        }

        .elf-predictions-list {
            margin-bottom: 20px;
        }

        .elf-prediction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f5f5f5;
            border-radius: 8px;
            font-size: 1.1em;
        }

        .elf-name {
            font-weight: bold;
            color: #555;
        }

        .elf-prediction {
            font-size: 1.3em;
        }

        .majority-vote-box {
            text-align: center;
            padding: 25px;
            background: #c8e6c9;
            border-radius: 10px;
            border: 3px solid #4CAF50;
        }

        .majority-vote-label {
            font-size: 1.1em;
            color: #2e7d32;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .majority-vote-result {
            font-size: 2.5em;
            font-weight: bold;
        }

        .student-choice-section {
            background: #fff9c4;
            border-radius: 15px;
            padding: 30px;
            border: 3px solid #ffc107;
            margin-top: 30px;
        }

        .student-choice-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .student-choice-header h3 {
            color: #f57c00;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .choice-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .choice-button {
            padding: 20px 40px;
            font-size: 1.5em;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            background: white;
            border: 3px solid #ffc107;
            transition: all 0.3s;
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-width: 200px;
        }

        .choice-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            border-color: #f57c00;
        }

        .choice-button.selected {
            background: #ffc107;
            border-color: #f57c00;
            transform: scale(1.05);
        }

        .result-message {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            display: none;
        }

        .result-message.show {
            display: block;
        }

        .result-message.happy {
            background: #c8e6c9;
            color: #2e7d32;
            border: 3px solid #4CAF50;
        }

        .result-message.not-happy {
            background: #ffcdd2;
            color: #c62828;
            border: 3px solid #f44336;
        }

        .bias-explanation {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            font-size: 1.1em;
            line-height: 1.6;
            display: none;
        }

        .bias-explanation.show {
            display: block;
        }

        .navigation {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .nav-button {
            padding: 15px 30px;
            font-size: 1.2em;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
        }

        .nav-button:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="language-selector">
            <select id="language-select" onchange="changeLanguage(this.value)">
                <option value="en">English</option>
                <option value="de">Deutsch</option>
                <option value="es">Espa√±ol</option>
                <option value="pt">Portugu√™s</option>
            </select>
        </div>
        
        <h1 data-translate="title">üéÖ Santa's Gift Tree - Bagging üéÑ</h1>
        
        <div class="intro">
            <p><strong data-translate="intro1">Now Santa's main elf and 4 helpers go to different sets of students and make respective trees to make a decision.</strong></p>
            <p data-translate="intro2">For some new students, each elf gives an output. Based on the outputs help choose the best gift for the new students!</p>
        </div>

        <!-- Student 1 -->
        <div class="student-section" id="student1-section">
            <div class="student-header">
                <h2>üë¶ Student 1: Alex</h2>
            </div>
            <div class="student-info">
                <p><strong>Age: 10</strong></p>
            </div>

            <div class="predictions-layout">
                <div class="prediction-panel main-elf">
                    <div class="panel-header main-elf">
                        <span>üîç</span>
                        <span data-translate="mainElfPred">Main Elf's Prediction</span>
                    </div>
                    <div class="main-elf-prediction" id="main-elf-1">
                        üìö Storybook
                    </div>
                </div>

                <div class="prediction-panel all-elves">
                    <div class="panel-header all-elves">
                        <span>üë•</span>
                        <span data-translate="allElvesPred">All 5 Elves' Predictions</span>
                    </div>
                    <div class="elf-predictions-list" id="all-elves-1">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div class="majority-vote-box">
                        <div class="majority-vote-label" data-translate="teamMajority">Team Majority Vote</div>
                        <div class="majority-vote-result" id="majority-1">üìö Storybook</div>
                    </div>
                </div>
            </div>

            <div class="student-choice-section">
                <div class="student-choice-header">
                    <h3 data-translate="whatDoYouThink">ü§î What Do You Think?</h3>
                    <p data-translate="whatDoYouThinkDesc">You've seen what the main elf predicted and what all 5 elves predicted. What do you think the gift should be?</p>
                </div>
                <div class="choice-buttons">
                    <button class="choice-button" onclick="makeChoice(1, 'Storybook')" data-translate="storybook">üìö Storybook</button>
                    <button class="choice-button" onclick="makeChoice(1, 'Football')" data-translate="football">üèà Football</button>
                </div>
                <div class="result-message" id="result-1"></div>
            </div>
        </div>

        <!-- Student 2 -->
        <div class="student-section" id="student2-section">
            <div class="student-header">
                <h2>üëß Student 2: Bella</h2>
            </div>
            <div class="student-info">
                <p><strong>Age: 12</strong></p>
            </div>

            <div class="predictions-layout">
                <div class="prediction-panel main-elf">
                    <div class="panel-header main-elf">
                        <span>üîç</span>
                        <span data-translate="mainElfPred">Main Elf's Prediction</span>
                    </div>
                    <div class="main-elf-prediction" id="main-elf-2">
                        üìö Storybook
                    </div>
                </div>

                <div class="prediction-panel all-elves">
                    <div class="panel-header all-elves">
                        <span>üë•</span>
                        <span data-translate="allElvesPred">All 5 Elves' Predictions</span>
                    </div>
                    <div class="elf-predictions-list" id="all-elves-2">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div class="majority-vote-box">
                        <div class="majority-vote-label" data-translate="teamMajority">Team Majority Vote</div>
                        <div class="majority-vote-result" id="majority-2">üèà Football</div>
                    </div>
                </div>
            </div>

            <div class="student-choice-section">
                <div class="student-choice-header">
                    <h3 data-translate="whatDoYouThink">ü§î What Do You Think?</h3>
                    <p data-translate="whatDoYouThinkDesc">You've seen what the main elf predicted and what all 5 elves predicted. What do you think the gift should be?</p>
                </div>
                <div class="choice-buttons">
                    <button class="choice-button" onclick="makeChoice(2, 'Storybook')" data-translate="storybook">üìö Storybook</button>
                    <button class="choice-button" onclick="makeChoice(2, 'Football')" data-translate="football">üèà Football</button>
                </div>
                <div class="result-message" id="result-2"></div>
                <div class="bias-explanation" id="bagging-explanation-2">
                    <p><strong data-translate="baggingExplanation">What just happened?</strong></p>
                    <p data-translate="baggingText">Sometimes one elf's tree gives a wrong gift, but the other elves get it right. When they vote together, their combined answer is often more reliable than using just one tree. Working as a team helps reduce random mistakes.</p>
                </div>
            </div>
        </div>

        <!-- Student 3 -->
        <div class="student-section" id="student3-section">
            <div class="student-header">
                <h2>üë¶ Student 3: Charlie</h2>
            </div>
            <div class="student-info">
                <p><strong>Age: 11</strong></p>
            </div>

            <div class="predictions-layout">
                <div class="prediction-panel main-elf">
                    <div class="panel-header main-elf">
                        <span>üîç</span>
                        <span data-translate="mainElfPred">Main Elf's Prediction</span>
                    </div>
                    <div class="main-elf-prediction" id="main-elf-3">
                        üìö Storybook
                    </div>
                </div>

                <div class="prediction-panel all-elves">
                    <div class="panel-header all-elves">
                        <span>üë•</span>
                        <span data-translate="allElvesPred">All 5 Elves' Predictions</span>
                    </div>
                    <div class="elf-predictions-list" id="all-elves-3">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <div class="majority-vote-box">
                        <div class="majority-vote-label" data-translate="teamMajority">Team Majority Vote</div>
                        <div class="majority-vote-result" id="majority-3">üìö Storybook</div>
                    </div>
                </div>
            </div>

            <div class="student-choice-section">
                <div class="student-choice-header">
                    <h3 data-translate="whatDoYouThink">ü§î What Do You Think?</h3>
                    <p data-translate="whatDoYouThinkDesc">You've seen what the main elf predicted and what all 5 elves predicted. What do you think the gift should be?</p>
                </div>
                <div class="choice-buttons">
                    <button class="choice-button" onclick="makeChoice(3, 'Storybook')" data-translate="storybook">üìö Storybook</button>
                    <button class="choice-button" onclick="makeChoice(3, 'Football')" data-translate="football">üèà Football</button>
                </div>
                <div class="result-message" id="result-3"></div>
                <div class="bias-explanation" id="bias-explanation">
                    <p><strong data-translate="biasExplanation">What just happened?</strong></p>
                    <p data-translate="biasText">Alex and Bella match what the elves had learned, so the vote worked well. But Charlie came from a different school with different gift preferences. All the elves had learned the same rule from similar data, so they all made the same wrong prediction. When every tree shares the same idea, they can all be wrong together.</p>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-button" onclick="window.location.href='index.html'" data-translate="back">‚Üê Back</button>
            <button class="nav-button" onclick="window.location.href='page3.html'" data-translate="next">Next ‚Üí</button>
        </div>
    </div>

    <script>
        // Translation system
        const translations = {
            en: {
                title: "üéÖ Santa's Gift Tree - Bagging üéÑ",
                intro1: "Now Santa's main elf and 4 helpers go to different sets of students and make respective trees to make a decision.",
                intro2: "For some new students, each elf gives an output. Based on the outputs help choose the best gift for the new students!",
                student: "Student",
                mainElfPred: "Main Elf's Prediction",
                allElvesPred: "All 5 Elves' Predictions",
                teamMajority: "Team Majority Vote",
                whatDoYouThink: "ü§î What Do You Think?",
                whatDoYouThinkDesc: "You've seen what the main elf predicted and what all 5 elves predicted. What do you think the gift should be?",
                storybook: "üìö Storybook",
                football: "üèà Football",
                baggingExplanation: "What just happened?",
                baggingText: "Sometimes one elf's tree gives a wrong gift, but the other elves get it right. When they vote together, their combined answer is often more reliable than using just one tree. Working as a team helps reduce random mistakes.",
                biasExplanation: "What just happened?",
                biasText: "Alex and Bella match what the elves had learned, so the vote worked well. But Charlie came from a different school with different gift preferences. All the elves had learned the same rule from similar data, so they all made the same wrong prediction. When every tree shares the same idea, they can all be wrong together.",
                back: "‚Üê Back",
                next: "Next ‚Üí",
                student1Happy: "üéâ Great choice! The student is happy! Both the main elf and majority vote were correct!",
                student1NotHappy: "üòî The student is not happy. Try choosing what the majority voted for!",
                student2Happy: "üéâ Great choice! The student is happy! The majority vote was correct, even though the main elf was wrong!",
                student2NotHappy: "üòî The student is not happy. The majority vote was correct - try choosing what the majority voted for!",
                student3NotHappyMajority: "üòî The student is still not happy, even though you chose what the majority voted for! This shows bias in the model.",
                student3NotHappy: "The Majority did not vote for Football. This is a case where even the majority vote was wrong due to bias!"
            },
            de: {
                title: "üéÖ Santas Geschenkbaum - Bagging üéÑ",
                intro1: "Jetzt gehen Santas Hauptelf und 4 Helfer zu verschiedenen Sch√ºlergruppen und erstellen jeweils B√§ume, um eine Entscheidung zu treffen.",
                intro2: "F√ºr einige neue Sch√ºler gibt jeder Elf eine Ausgabe. Basierend auf den Ausgaben helfen Sie, das beste Geschenk f√ºr die neuen Sch√ºler zu w√§hlen!",
                student: "Sch√ºler",
                mainElfPred: "Vorhersage des Hauptelfen",
                allElvesPred: "Vorhersagen aller 5 Elfen",
                teamMajority: "Mehrheitsentscheidung des Teams",
                whatDoYouThink: "ü§î Was denkst du?",
                whatDoYouThinkDesc: "Du hast gesehen, was der Hauptelf vorhergesagt hat und was alle 5 Elfen vorhergesagt haben. Was denkst du, sollte das Geschenk sein?",
                storybook: "üìö Geschichtenbuch",
                football: "üèà Fu√üball",
                baggingExplanation: "Was ist passiert?",
                baggingText: "Manchmal gibt der Baum eines Elfen ein falsches Geschenk, aber die anderen Elfen haben recht. Wenn sie zusammen abstimmen, ist ihre kombinierte Antwort oft zuverl√§ssiger als die Verwendung nur eines Baumes. Teamarbeit hilft, zuf√§llige Fehler zu reduzieren.",
                biasExplanation: "Was ist passiert?",
                biasText: "Alex und Bella passen zu dem, was die Elfen gelernt hatten, daher funktionierte die Abstimmung gut. Aber Charlie kam aus einer anderen Schule mit unterschiedlichen Geschenkpr√§ferenzen. Alle Elfen hatten die gleiche Regel aus √§hnlichen Daten gelernt, daher machten sie alle die gleiche falsche Vorhersage. Wenn jeder Baum die gleiche Idee teilt, k√∂nnen sie alle zusammen falsch liegen.",
                back: "‚Üê Zur√ºck",
                next: "Weiter ‚Üí",
                student1Happy: "üéâ Gro√üe Wahl! Der Sch√ºler ist gl√ºcklich! Sowohl der Hauptelf als auch die Mehrheitsabstimmung waren richtig!",
                student1NotHappy: "üòî Der Sch√ºler ist nicht gl√ºcklich. Versuchen Sie, das zu w√§hlen, wof√ºr die Mehrheit gestimmt hat!",
                student2Happy: "üéâ Gro√üe Wahl! Der Sch√ºler ist gl√ºcklich! Die Mehrheitsabstimmung war richtig, obwohl der Hauptelf falsch lag!",
                student2NotHappy: "üòî Der Sch√ºler ist nicht gl√ºcklich. Die Mehrheitsabstimmung war richtig - versuchen Sie, das zu w√§hlen, wof√ºr die Mehrheit gestimmt hat!",
                student3NotHappyMajority: "üòî Der Sch√ºler ist immer noch nicht gl√ºcklich, obwohl Sie das gew√§hlt haben, wof√ºr die Mehrheit gestimmt hat! Dies zeigt Voreingenommenheit im Modell.",
                student3NotHappy: "Die Mehrheit hat nicht f√ºr Fu√üball gestimmt. Dies ist ein Fall, in dem sogar die Mehrheitsabstimmung aufgrund von Voreingenommenheit falsch war!"
            },
            es: {
                title: "üéÖ El √Årbol de Regalos de Santa - Bagging üéÑ",
                intro1: "Ahora el elfo principal de Santa y 4 ayudantes van a diferentes grupos de estudiantes y hacen √°rboles respectivos para tomar una decisi√≥n.",
                intro2: "Para algunos estudiantes nuevos, cada elfo da una salida. ¬°Bas√°ndote en las salidas, ayuda a elegir el mejor regalo para los nuevos estudiantes!",
                student: "Estudiante",
                mainElfPred: "Predicci√≥n del Elfo Principal",
                allElvesPred: "Predicciones de los 5 Elfos",
                teamMajority: "Voto Mayoritario del Equipo",
                whatDoYouThink: "ü§î ¬øQu√© piensas?",
                whatDoYouThinkDesc: "Has visto lo que predijo el elfo principal y lo que predijeron los 5 elfos. ¬øQu√© crees que deber√≠a ser el regalo?",
                storybook: "üìö Libro de Cuentos",
                football: "üèà F√∫tbol",
                baggingExplanation: "¬øQu√© acaba de pasar?",
                baggingText: "A veces el √°rbol de un elfo da un regalo equivocado, pero los otros elfos lo hacen bien. Cuando votan juntos, su respuesta combinada suele ser m√°s confiable que usar solo un √°rbol. Trabajar en equipo ayuda a reducir errores aleatorios.",
                biasExplanation: "¬øQu√© acaba de pasar?",
                biasText: "Alex y Bella coinciden con lo que los elfos hab√≠an aprendido, por lo que la votaci√≥n funcion√≥ bien. Pero Charlie vino de una escuela diferente con diferentes preferencias de regalos. Todos los elfos hab√≠an aprendido la misma regla de datos similares, por lo que todos hicieron la misma predicci√≥n incorrecta. Cuando cada √°rbol comparte la misma idea, todos pueden estar equivocados juntos.",
                back: "‚Üê Atr√°s",
                next: "Siguiente ‚Üí",
                student1Happy: "üéâ ¬°Excelente elecci√≥n! ¬°El estudiante est√° feliz! ¬°Tanto el elfo principal como el voto mayoritario fueron correctos!",
                student1NotHappy: "üòî El estudiante no est√° feliz. ¬°Intenta elegir lo que vot√≥ la mayor√≠a!",
                student2Happy: "üéâ ¬°Excelente elecci√≥n! ¬°El estudiante est√° feliz! ¬°El voto mayoritario fue correcto, aunque el elfo principal estaba equivocado!",
                student2NotHappy: "üòî El estudiante no est√° feliz. El voto mayoritario fue correcto - ¬°intenta elegir lo que vot√≥ la mayor√≠a!",
                student3NotHappyMajority: "üòî El estudiante todav√≠a no est√° feliz, ¬°aunque elegiste lo que vot√≥ la mayor√≠a! Esto muestra sesgo en el modelo.",
                student3NotHappy: "La mayor√≠a no vot√≥ por F√∫tbol. ¬°Este es un caso donde incluso el voto mayoritario estuvo equivocado debido al sesgo!"
            },
            pt: {
                title: "üéÖ √Årvore de Presentes do Papai Noel - Bagging üéÑ",
                intro1: "Agora o elfo principal do Papai Noel e 4 ajudantes v√£o para diferentes grupos de alunos e fazem √°rvores respectivas para tomar uma decis√£o.",
                intro2: "Para alguns alunos novos, cada elfo d√° uma sa√≠da. Com base nas sa√≠das, ajude a escolher o melhor presente para os novos alunos!",
                student: "Aluno",
                mainElfPred: "Predi√ß√£o do Elfo Principal",
                allElvesPred: "Predi√ß√µes dos 5 Elfos",
                teamMajority: "Voto Majorit√°rio da Equipe",
                whatDoYouThink: "ü§î O que voc√™ acha?",
                whatDoYouThinkDesc: "Voc√™ viu o que o elfo principal previu e o que os 5 elfos previram. O que voc√™ acha que o presente deveria ser?",
                storybook: "üìö Livro de Hist√≥rias",
                football: "üèà Futebol",
                baggingExplanation: "O que acabou de acontecer?",
                baggingText: "√Äs vezes, a √°rvore de um elfo d√° um presente errado, mas os outros elfos acertam. Quando votam juntos, sua resposta combinada geralmente √© mais confi√°vel do que usar apenas uma √°rvore. Trabalhar em equipe ajuda a reduzir erros aleat√≥rios.",
                biasExplanation: "O que acabou de acontecer?",
                biasText: "Alex e Bella correspondem ao que os elfos haviam aprendido, ent√£o a vota√ß√£o funcionou bem. Mas Charlie veio de uma escola diferente com prefer√™ncias de presentes diferentes. Todos os elfos haviam aprendido a mesma regra de dados semelhantes, ent√£o todos fizeram a mesma predi√ß√£o errada. Quando cada √°rvore compartilha a mesma ideia, todas podem estar erradas juntas.",
                back: "‚Üê Voltar",
                next: "Pr√≥ximo ‚Üí",
                student1Happy: "üéâ √ìtima escolha! O aluno est√° feliz! Tanto o elfo principal quanto o voto majorit√°rio estavam corretos!",
                student1NotHappy: "üòî O aluno n√£o est√° feliz. Tente escolher o que a maioria votou!",
                student2Happy: "üéâ √ìtima escolha! O aluno est√° feliz! O voto majorit√°rio estava correto, mesmo que o elfo principal estivesse errado!",
                student2NotHappy: "üòî O aluno n√£o est√° feliz. O voto majorit√°rio estava correto - tente escolher o que a maioria votou!",
                student3NotHappyMajority: "üòî O aluno ainda n√£o est√° feliz, mesmo que voc√™ tenha escolhido o que a maioria votou! Isso mostra vi√©s no modelo.",
                student3NotHappy: "A maioria n√£o votou em Futebol. Este √© um caso onde mesmo o voto majorit√°rio estava errado devido ao vi√©s!"
            }
        };

        let currentLanguage = localStorage.getItem('language') || 'en';

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            updateTranslations();
        }

        function updateTranslations() {
            const t = translations[currentLanguage];
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                if (t[key]) {
                    if (el.tagName === 'INPUT') {
                        el.value = t[key];
                    } else if (el.tagName === 'BUTTON') {
                        el.textContent = t[key];
                    } else {
                        el.textContent = t[key];
                    }
                }
            });
            document.getElementById('language-select').value = currentLanguage;
            // Update predictions display with new language
            initializePredictions();
        }

        // Initialize language on page load
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('language-select').value = currentLanguage;
            updateTranslations();
        });

        // Define the 5 elves and their tree thresholds
        // Main Elf + 4 Helpers
        const elves = [
            {name: 'Main Elf', threshold: 11, isMain: true},
            {name: 'Helper 1', threshold: 10, isMain: false},
            {name: 'Helper 2', threshold: 12, isMain: false},
            {name: 'Helper 3', threshold: 13, isMain: false},
            {name: 'Helper 4', threshold: 14, isMain: false}
        ];

        // Test students with their ages and correct answers
        // Case 1: Alex (age 10) - Main and majority agree, both correct
        //   Main (11): 10 < 11 ‚Üí Storybook ‚úì
        //   H1 (10): 10 < 10 ‚Üí Football, H2 (12): 10 < 12 ‚Üí Storybook, H3 (13): 10 < 13 ‚Üí Storybook, H4 (14): 10 < 14 ‚Üí Storybook
        //   Majority: 4 Storybook, 1 Football ‚Üí Storybook ‚úì
        // Case 2: Bella (age 12) - Main wrong, majority correct
        //   Main (11): 12 >= 11 ‚Üí Football, but we want Main wrong, so Main threshold should be > 12
        //   Let's use different thresholds for Case 2
        // Case 3: Charlie (age 11) - Main and majority agree, both wrong (bias)
        //   Main (11): 11 < 11 ‚Üí Football, but correct is Football... need to adjust
        
        // For Case 2, we'll use different thresholds dynamically
        const students = [
            {name: 'Alex', age: 10, correctGift: 'Storybook'},  // Case 1: Main and majority agree, both correct
            {name: 'Bella', age: 12, correctGift: 'Football'},  // Case 2: Main wrong, majority correct
            {name: 'Charlie', age: 11, correctGift: 'Football'} // Case 3: Main and majority agree, both wrong (bias)
        ];
        
        // Special thresholds for Case 2 (Bella) to show main wrong but majority correct
        const elvesCase2 = [
            {name: 'Main Elf', threshold: 13, isMain: true},  // 12 < 13 ‚Üí Storybook (WRONG, correct is Football)
            {name: 'Helper 1', threshold: 11, isMain: false}, // 12 >= 11 ‚Üí Football (CORRECT)
            {name: 'Helper 2', threshold: 11, isMain: false}, // 12 >= 11 ‚Üí Football (CORRECT)
            {name: 'Helper 3', threshold: 11, isMain: false}, // 12 >= 11 ‚Üí Football (CORRECT)
            {name: 'Helper 4', threshold: 11, isMain: false}  // 12 >= 11 ‚Üí Football (CORRECT)
        ];
        
        // Special thresholds for Case 3 (Charlie) to show bias
        const elvesCase3 = [
            {name: 'Main Elf', threshold: 12, isMain: true},  // 11 < 12 ‚Üí Storybook (WRONG, correct is Football)
            {name: 'Helper 1', threshold: 12, isMain: false}, // 11 < 12 ‚Üí Storybook (WRONG)
            {name: 'Helper 2', threshold: 12, isMain: false}, // 11 < 12 ‚Üí Storybook (WRONG)
            {name: 'Helper 3', threshold: 12, isMain: false}, // 11 < 12 ‚Üí Storybook (WRONG)
            {name: 'Helper 4', threshold: 11, isMain: false}  // 11 < 11 ‚Üí Football (CORRECT, but minority)
        ];

        /**
         * Get prediction from an elf based on age and threshold
         */
        function getPrediction(age, threshold) {
            return age < threshold ? 'Storybook' : 'Football';
        }

        /**
         * Get all predictions for a student
         */
        function getAllPredictions(studentAge, studentNum) {
            // Use different elf sets for different cases
            let elfSet = elves;
            if (studentNum === 2) {
                elfSet = elvesCase2;
            } else if (studentNum === 3) {
                elfSet = elvesCase3;
            }
            
            return elfSet.map(elf => ({
                name: elf.name,
                prediction: getPrediction(studentAge, elf.threshold),
                isMain: elf.isMain
            }));
        }

        /**
         * Calculate majority vote
         */
        function getMajorityVote(predictions) {
            const storybookCount = predictions.filter(p => p.prediction === 'Storybook').length;
            const footballCount = predictions.filter(p => p.prediction === 'Football').length;
            
            if (storybookCount > footballCount) {
                return 'Storybook';
            } else if (footballCount > storybookCount) {
                return 'Football';
            } else {
                // Tie - return first prediction
                return predictions[0].prediction;
            }
        }

        /**
         * Initialize all students' predictions on page load
         */
        function initializePredictions() {
            const t = translations[currentLanguage];
            students.forEach((student, index) => {
                const studentNum = index + 1;
                const predictions = getAllPredictions(student.age, studentNum);
                const mainElfPred = predictions.find(p => p.isMain);
                const majority = getMajorityVote(predictions);

                // Display main elf prediction
                const mainElfDiv = document.getElementById(`main-elf-${studentNum}`);
                mainElfDiv.textContent = mainElfPred.prediction === 'Storybook' ? t.storybook : t.football;

                // Display all elves' predictions
                const allElvesDiv = document.getElementById(`all-elves-${studentNum}`);
                allElvesDiv.innerHTML = '';
                predictions.forEach(elf => {
                    const item = document.createElement('div');
                    item.className = 'elf-prediction-item';
                    item.innerHTML = `
                        <span class="elf-name">${elf.name}:</span>
                        <span class="elf-prediction">${elf.prediction === 'Storybook' ? t.storybook : t.football}</span>
                    `;
                    allElvesDiv.appendChild(item);
                });

                // Display majority vote
                const majorityDiv = document.getElementById(`majority-${studentNum}`);
                majorityDiv.textContent = majority === 'Storybook' ? t.storybook : t.football;
            });
        }

        /**
         * Handle student's choice
         */
        function makeChoice(studentNum, chosenGift) {
            const t = translations[currentLanguage];
            const student = students[studentNum - 1];
            const predictions = getAllPredictions(student.age, studentNum);
            const mainElfPred = predictions.find(p => p.isMain);
            const majority = getMajorityVote(predictions);
            const resultDiv = document.getElementById(`result-${studentNum}`);

            // Remove previous selections
            const section = document.getElementById(`student${studentNum}-section`);
            section.querySelectorAll('.choice-button').forEach(btn => {
                btn.classList.remove('selected');
            });

            // Mark selected button
            event.target.classList.add('selected');

            // Determine result based on case
            let isHappy = false;
            let message = '';

            if (studentNum === 1) {
                // Case 1: Main and majority agree, both correct
                // Student happy if chooses correctly (which matches both)
                isHappy = chosenGift === student.correctGift;
                if (isHappy) {
                    message = t.student1Happy;
                } else {
                    message = t.student1NotHappy;
                }
            } else if (studentNum === 2) {
                // Case 2: Main wrong, majority correct
                // Student happy only if chooses what majority voted
                isHappy = chosenGift === majority;
                if (isHappy) {
                    message = t.student2Happy;
                } else {
                    message = t.student2NotHappy;
                }
                
                // Show bagging explanation
                document.getElementById('bagging-explanation-2').classList.add('show');
            } else if (studentNum === 3) {
                // Case 3: Main and majority agree, but both wrong (bias)
                // Student NOT happy even if chooses majority
                isHappy = false;
                if (chosenGift === majority) {
                    message = t.student3NotHappyMajority;
                } else {
                    message = t.student3NotHappy;
                }
                
                // Show bias explanation
                document.getElementById('bias-explanation').classList.add('show');
            }

            // Display result
            resultDiv.textContent = message;
            resultDiv.className = `result-message show ${isHappy ? 'happy' : 'not-happy'}`;
        }

        // Initialize on page load
        initializePredictions();
    </script>
</body>
</html>
